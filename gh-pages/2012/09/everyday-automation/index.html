<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Primary Unit mirror on GitHub – Everyday automation</title>

  <!-- Load my combined stylesheet -->
  <link rel="stylesheet" href="/resources/all.min.css">


  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/">

  <link rel="alternate" type="application/rss+xml" title="RSS feed for Primary Unit" href="/rss">
  <link rel="alternate" type="application/json" title="JSON feed for Primary Unit" href="/feed.json">

  <!-- Apple pinned sites icon, Apple touch icon, Favicon -->
  <link rel="mask-icon" href="/resources/favicon.svg" color="#1369BF">
  <link rel="apple-touch-icon-precomposed" href="/resources/favicon.png">
  <link rel="icon" href="/resources/favicon.ico">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="A mirror of https://www.robjwells.com hosted on GitHub">
</head>

<body>

<div class="wrapper">

<header class="site-header">

  <div class="site-title-container mute-links">
    <h1 class="site-title"><a href="https://robjwells.github.io">Primary Unit mirror on GitHub</a></h1>
    <p class="site-byline"><i>by</i> Rob Wells</p>
  </div>

  <div class="site-menu-container">

    <nav id="site-nav">
      <ul class="site-links mute-links">
        <li><a href="/about/">About</a></li>
        <li><a href="/archives/">Archives</a></li>
        <li><a href="/feed.json">JSON&nbsp;feed</a></li>
        <li><a href="/rss">RSS&nbsp;feed</a></li>
      </ul>
    </nav>

    <label for="search-field" class="site-search-label">
      Site search
    </label>
    <form id="site-search" class="site-search" method="get" action="https://duckduckgo.com/">
      <input name="q" type="text" id="search-field" class="search-field" placeholder="via DuckDuckGo">
      <input name="sites" value="https://robjwells.github.io" hidden>
      <button type="submit" class="search-button">Search</button>
    </form>

  </div> <!-- .site-menu-container -->

</header> <!-- .site-header -->

<main role="main">

  <article>
    <header>
      <h2 class="mute-links"><a href="https://robjwells.github.io/2012/09/everyday-automation/">Everyday automation</a></h2>
      <p><time datetime="2012-09-18T18:23">Tuesday, September 18 2012</time></p>
    </header>
    <p>Learning AppleScript can really pay off.</p>
<p>It isn’t always the easiest language to work with, as anyone who’s ever used it will tell you. Commands that look like they should work sometimes don’t, you occasionally have to use bizarre methods to refer to <em>that thing right there</em>. It’s not a picnic.</p>
<p>But I’ve been using it for a little while and am pretty comfortable with it. I’ve ended up using it more and more for everyday tasks, or one-off situations that would usually require a lot of donkey work.</p>
<p>Let me share one that’s just happened.</p>
<p>I was browsing <a href="http://www.condenaststore.com/-se/newyorkerstore.htm">the New Yorker’s print shop</a> and — I thought — was opening up the individual pages for covers I liked and wanted to go back to after I’d finished browsing.</p>
<p>It turns out that I was just opening up the preview images in tabs. Whoops. And their URLs don’t contain a unique code that’s shared with their purchase pages. Ah. And there are 10 of them. Erm.</p>
<p>The one similarity they do have is that the filename is kinda sorta repeated on the purchase page, but it’s hyphen-separated so (<em>I thought, wrongly</em>) you can’t just copy and paste it into a search field.</p>
<p>So I cooked up this little script in about a minute:</p>
<pre><code>tell application &quot;Safari&quot;
    set theURL to (get the URL of the front document)
end tell

set printsOffset to (get the offset of &quot;/prints/&quot; in theURL)
set jpgOffset to (get the offset of &quot;.jpg&quot; in theURL)

set hyphenString to characters (printsOffset + 8) ¬
through (jpgOffset - 1) of theURL as text
set AppleScript's text item delimiters to &quot;-&quot;
set theWords to (get the text items of hyphenString)
set AppleScript's text item delimiters to &quot; &quot;
set searchString to theWords as string
set AppleScript's text item delimiters to &quot;&quot; -- return to default

tell application &quot;Safari&quot;
    tell the front document
        search the web for searchString
    end tell
end tell</code></pre>


<p>Then I saved it, gave it a shortcut in <a href="http://www.red-sweater.com/fastscripts/">FastScripts</a>, opened up the first tab in Safari, hit the shortcut, tabbed to select the first URL in the search results, then hit enter to load it. Rinse, repeat.</p>
<p>As I was writing this I tried just pasting the filename into Google and — shocker — that works. Which makes me look a little dumb.</p>
<p>And the script isn’t even that sophisticated; I could have used a repeat command to loop through each tab, for example.</p>
<p>However my wider point about getting your teeth into automation still stands. I’ve written loads of little scripts like this over the past few months and, combined, they’ve saved me bags of time and plenty of frustration.</p>
<p>Hell, the InDesign script I wrote to set a text frame’s name (≥CS5) to its script label (≤CS4) alone saved me half an hour.</p>
<p>The problem of AppleScript being frustrating to learn — and continually frustrating with certain applications’ opaque AppleScript dictionaries and command parsing — does stand in the way of more people using it (which is why Automator exists, as limited as it is).</p>
<p>But if you’re tempted, even a little, give it a go. If you don’t have any programming experience I recommend <a href="http://www.amazon.co.uk/AppleScript-1-2-3-Self-Paced-Learning-Training/dp/0321149319/ref=sr_1_1?ie=UTF8&amp;qid=1347986804&amp;sr=8-1">AppleScript 1-2-3</a>. (Don’t buy the Kindle edition. You want the paper copy.)</p>
<p>Also make sure to check out <a href="http://www.latenightsw.com">Script Debugger 5</a>, which at $199 (about £170 including VAT) is a bit pricey if you’re just starting but makes things so much easier it’s a joke. It’s like switching from MSPaint to Photoshop. You’ll never go back to (Apple)Script Editor.</p>
<div class="flag">
  <p><strong>Update 2012-09-12</p></strong>
  <p>“Learning AppleScript can really pay off. Once you’ve suffered through its oddities enough to be able to write it without weeping, you’ll be tempted to write scripts that achieve things you can do with copy and paste, like this one.”</p>
  <p>Maybe I should have thought harder about that first line.</p>
</div>
  </article>

</main>

<footer class="site-footer">
  <small class="mute-links">
    This work is licensed under a
    <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">
    Creative Commons Attribution 4.0 International License</a>.
  </small>
</footer> <!-- .site-footer -->

</div> <!-- .wrapper -->

</body>

</html>