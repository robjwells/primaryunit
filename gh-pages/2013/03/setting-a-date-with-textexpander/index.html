<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Primary Unit mirror on GitHub – Setting a date with TextExpander</title>

  <!-- Load my combined stylesheet -->
  <link rel="stylesheet" href="/resources/all.min.css">


  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/">

  <link rel="alternate" type="application/rss+xml" title="RSS feed for Primary Unit" href="/rss">
  <link rel="alternate" type="application/json" title="JSON feed for Primary Unit" href="/feed.json">

  <!-- Apple pinned sites icon, Apple touch icon, Favicon -->
  <link rel="mask-icon" href="/resources/favicon.svg" color="#1369BF">
  <link rel="apple-touch-icon-precomposed" href="/resources/favicon.png">
  <link rel="icon" href="/resources/favicon.ico">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="A mirror of https://www.robjwells.com hosted on GitHub">
</head>

<body>

<div class="wrapper">

<header class="site-header">

  <div class="site-title-container mute-links">
    <h1 class="site-title"><a href="https://robjwells.github.io">Primary Unit mirror on GitHub</a></h1>
    <p class="site-byline"><i>by</i> Rob Wells</p>
  </div>

  <div class="site-menu-container">

    <nav id="site-nav">
      <ul class="site-links mute-links">
        <li><a href="/about/">About</a></li>
        <li><a href="/archives/">Archives</a></li>
        <li><a href="/feed.json">JSON&nbsp;feed</a></li>
        <li><a href="/rss">RSS&nbsp;feed</a></li>
      </ul>
    </nav>

    <label for="search-field" class="site-search-label">
      Site search
    </label>
    <form id="site-search" class="site-search" method="get" action="https://duckduckgo.com/">
      <input name="q" type="text" id="search-field" class="search-field" placeholder="via DuckDuckGo">
      <input name="sites" value="https://robjwells.github.io" hidden>
      <button type="submit" class="search-button">Search</button>
    </form>

  </div> <!-- .site-menu-container -->

</header> <!-- .site-header -->

<main role="main">

  <article>
    <header>
      <h2 class="mute-links"><a href="https://robjwells.github.io/2013/03/setting-a-date-with-textexpander/">Setting a date with TextExpander</a></h2>
      <p><time datetime="2013-03-06T10:45">Wednesday, March 6 2013</time></p>
    </header>
    <p>I suck at dates. Badly.</p>
<p>Thankfully, there are a few ways to get around this in software — not least <a href="http://smilesoftware.com/TextExpander/index.html">TextExpander</a>, Smile’s ace text-substitution program. (I don’t use it nearly enough, but <a href="http://www.takecontrolbooks.com/textexpander">I’m looking to fix that</a>.)</p>
<p>TextExpander has a lot of date placeholders, so it’s obvious that I’m not the only one that needs help with this — but I may well be the first to be <em>this</em> bad. Here’s a list of the snippets in my Time &amp; Date folder:</p>
<pre><code>;mdate   -&gt;   March 6 2013
;*ddate  -&gt;   Wednesday March 6 2013
;ds      -&gt;   _0306_0914
;time    -&gt;   09:14
;bd      -&gt;   20130306
;ldate   -&gt;   March 6, 2013
;sdate   -&gt;   06/03/2013
;dt      -&gt;   09:14, March 6, 2013</code></pre>


<p>Those eight snippets include <em>seven</em> different ways to get the date, and <em>three</em> different ways to get the time. The worst part about this is that I can never remember which abbreviation corresponds to which date format.</p>
<p>Ok, let’s fix this. How many formats do I really need? I need a short date, a more human-friendly long date, the time, and the format used at <a href="http://www.morningstaronline.co.uk">work</a>.</p>
<p>So that’s four — only half as bad as before!</p>
<h3>Time</h3>
<p>I’m sticking with my old <code>;time</code> snippet here, a colon-separated 24-hour time. If I need a more human-friendly time, typing 10am or 8pm or whatever is as easy as typing an abbreviation (and TextExpander only does uppercase AM/PM, which I dislike). Here’s the snippet:</p>
<pre><code>%H:%M   -&gt;    10:23</code></pre>


<h3>Short date</h3>
<p>Because, well, <a href="http://xkcd.com/1179/">XKCD</a>, I’m going to use the <a href="http://en.wikipedia.org/wiki/ISO_8601">ISO 8601 date format</a> for this. It means I can dump my separate backwards date snippet and avoids any confusion across DD/MM/YY and MM/DD/YY countries.</p>
<pre><code>%Y-%m-%d    -&gt;  2013-03-06</code></pre>


<h3>Long date</h3>
<p>Since this is implicitly not the format to use when you’re counting characters and one that’s explicit enough to avoid confusion, there’s quite a bit of personal freedom here.</p>
<p>This one’s going to be more complicated than the previous two, as I want to use date suffixes (March 2nd, April 21st, etc). But TextExpander doesn't include a suffix placeholder, so let’s take advantage of its script support.</p>
<p>AppleScript’s built-in <code>current date</code> command returns an object from which we can extract all the pieces we need to construct a date, like so:</p>
<pre><code>set theDate to the day of the (current date)
set theDay to the weekday of the (current date)
set theMonth to the month of the (current date)
set theYear to the year of the (current date)</code></pre>


<p>Now to build the suffix. Most dates have the suffix “th”, so we want to focus on the special cases: 1, 2, 3, 21, 22, and 31. We could check for each of these but there’s a smarter way.</p>
<p>We need to pull the date’s <strong>last</strong> character, which determines the suffix, so we can work with both single and double-digit dates:</p>
<pre><code>set lastChar to (the last character of (theDate as string))¬
 as number</code></pre>


<p>Now we check for the most common situation (“th”) by testing <code>lastChar</code> against a range:</p>
<pre><code>if lastChar is 0 or lastChar &gt; 3 or (theDate &gt; 10 and¬
 theDate &lt; 21) then
    set theDate to (theDate as string) &amp; &quot;th&quot;</code></pre>


<p>If we put the other suffixes in order and in a list, we can use the last character of the date itself to extract the correct suffix:</p>
<pre><code>set theSuffixes to {&quot;st&quot;, &quot;nd&quot;, &quot;rd&quot;}
set theDate to (theDate as string) &amp; (item lastChar¬
 of theSuffixes)</code></pre>


<p>Now let’s roll it up and <code>return</code> a constructed date:</p>
<pre><code>set theDate to the day of the (current date)
set theDay to the weekday of the (current date)
set theMonth to the month of the (current date)
set theYear to the year of the (current date)

set lastChar to (the last character of (theDate as string))¬
 as number

if lastChar &gt; 3 or lastChar is 0 or (theDate &gt; 10 and¬
 theDate &lt; 21) then
    set theDate to (theDate as string) &amp; &quot;th&quot;
else
    set theSuffixes to {&quot;st&quot;, &quot;nd&quot;, &quot;rd&quot;}
    set theDate to (theDate as string) &amp; (item lastChar¬
     of theSuffixes)
end if

return (theDay &amp; &quot;, &quot; &amp; theMonth &amp; &quot; &quot; &amp; theDate &amp; &quot;, &quot; &amp;¬
 theYear) as string</code></pre>


<h3>End result</h3>
<p>Hey! You made it! I was sure I’d lose everyone in the middle of breaking down that AppleScript.</p>
<p>So, here’s what I’m left with:</p>
<pre><code>;iso    -&gt;    2013-03-06
;ldt    -&gt;    Wednesday, March 6th, 2013
;tm     -&gt;    10:21</code></pre>


<p>Mix in one for work:</p>
<pre><code>;*dt    -&gt;    Wednesday March 6 2013</code></pre>


<p>And we’re all set.</p>
  </article>

</main>

<footer class="site-footer">
  <small class="mute-links">
    This work is licensed under a
    <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">
    Creative Commons Attribution 4.0 International License</a>.
  </small>
</footer> <!-- .site-footer -->

</div> <!-- .wrapper -->

</body>

</html>