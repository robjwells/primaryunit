<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Primary Unit mirror on GitHub – Updated date suffix script</title>

  <!-- Load my combined stylesheet -->
  <link rel="stylesheet" href="/resources/all.min.css">


  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/">

  <link rel="alternate" type="application/rss+xml" title="RSS feed for Primary Unit" href="/rss">
  <link rel="alternate" type="application/json" title="JSON feed for Primary Unit" href="/feed.json">

  <!-- Apple pinned sites icon, Apple touch icon, Favicon -->
  <link rel="mask-icon" href="/resources/favicon.svg" color="#1369BF">
  <link rel="apple-touch-icon-precomposed" href="/resources/favicon.png">
  <link rel="icon" href="/resources/favicon.ico">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="A mirror of https://www.robjwells.com hosted on GitHub">
</head>

<body>

<div class="wrapper">

<header class="site-header">

  <div class="site-title-container mute-links">
    <h1 class="site-title"><a href="https://robjwells.github.io">Primary Unit mirror on GitHub</a></h1>
    <p class="site-byline"><i>by</i> Rob Wells</p>
  </div>

  <div class="site-menu-container">

    <nav id="site-nav">
      <ul class="site-links mute-links">
        <li><a href="/about/">About</a></li>
        <li><a href="/archives/">Archives</a></li>
        <li><a href="/feed.json">JSON&nbsp;feed</a></li>
        <li><a href="/rss">RSS&nbsp;feed</a></li>
      </ul>
    </nav>

    <label for="search-field" class="site-search-label">
      Site search
    </label>
    <form id="site-search" class="site-search" method="get" action="https://duckduckgo.com/">
      <input name="q" type="text" id="search-field" class="search-field" placeholder="via DuckDuckGo">
      <input name="sites" value="https://robjwells.github.io" hidden>
      <button type="submit" class="search-button">Search</button>
    </form>

  </div> <!-- .site-menu-container -->

</header> <!-- .site-header -->

<main role="main">

  <article>
    <header>
      <h2 class="mute-links"><a href="https://robjwells.github.io/2015/01/updated-date-suffix-script/">Updated date suffix script</a></h2>
      <p><time datetime="2015-01-17T18:56">Saturday, January 17 2015</time></p>
    </header>
    <p>One of my favourite scripts is <a href="/2013/10/date-suffixes-in-python/">a snippet of Python that produces a date with an ordinal suffix</a>. It’s <a href="http://stilldrinking.org/programming-sucks">short, simple</a>, and was probably the first thing I did in Python that made me sit back and smile.</p>
<p>But it contains a hack to prevent the day of the month from being prefixed with a zero (<code>%d</code>) or a space (<code>%e</code>). I recently <a href="http://www.leancrew.com/all-this/2013/02/new-flexible-timestamps-in-drafts/">discovered</a> that you can use a hyphen in the format specifier to prevent this: <code>%-d</code>.</p>
<p>Also, the method of inserting the suffixed day just uses <code>str.replace</code> to replace a hash mark. But what if you need a hash mark in your date string? Not ideal, and easily solved with Python’s <code>str.format</code>.</p>
<p>Here’s the new code:</p>
<pre><code>from datetime import date

def ordinal_suffix(day):
  if 3 &lt; day &lt; 21 or 23 &lt; day &lt; 31:
    return 'th'
  else:
    return {1: 'st', 2: 'nd', 3: 'rd'}[day % 10]

today = date.today()
date_string = today.strftime('%A, %B %-d{suffix}, %Y')
print(date_string.format(suffix=ordinal_suffix(today.day)))</code></pre>


<p>Starting with the date string on line 10, <code>%-d</code> surpasses the prefix, and we include a replacement field (<code>{suffix}</code>). That gets formatted with the output of the <code>ordinal_suffix</code> function.</p>
<p>The logic there is largely the same as <a href="/2013/10/date-suffixes-in-python/">before</a> <del datetime="2015-01-17">except that I’m treating the 1x numbers as a special case in line 4 (which I appreciate is a bit silly given the range 1-31, but 0x, 2x and 3x days all conform)</del>. <ins datetime="2015-01-17">Given a bit more thought, it makes sense to handle all <code>th</code> suffixes in the True part of the conditional.</ins> Everything else, as before, gets reduced to the final digit and is used to index into the dictionary in line 7 <del datetime="2015-01-17">— using <code>get</code> to supply <code>th</code> as a default</del>.</p>
<p>It may seem silly to revisit this — this may as well be <a href="https://en.wikipedia.org/wiki/Fizz_buzz">fizzbuzz</a> — but I really don’t like leaving blog posts that I <em>know</em> are incorrect in some way. I hate the idea that someone may stumble across a post and take away an idea that isn’t the best that I could provide them. And really this is a learning process for me: I think something is one way, write about it, come to a better conclusion, and write about it again.</p>
  </article>

</main>

<footer class="site-footer">
  <small class="mute-links">
    This work is licensed under a
    <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">
    Creative Commons Attribution 4.0 International License</a>.
  </small>
</footer> <!-- .site-footer -->

</div> <!-- .wrapper -->

</body>

</html>