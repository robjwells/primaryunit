<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Primary Unit mirror on GitHub – My email nightmare</title>

  <!-- Load my combined stylesheet -->
  <link rel="stylesheet" href="/resources/all.min.css">


  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/">

  <link rel="alternate" type="application/rss+xml" title="RSS feed for Primary Unit" href="/rss">
  <link rel="alternate" type="application/json" title="JSON feed for Primary Unit" href="/feed.json">

  <!-- Apple pinned sites icon, Apple touch icon, Favicon -->
  <link rel="mask-icon" href="/resources/favicon.svg" color="#1369BF">
  <link rel="apple-touch-icon-precomposed" href="/resources/favicon.png">
  <link rel="icon" href="/resources/favicon.ico">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="A mirror of https://www.robjwells.com hosted on GitHub">
</head>

<body>

<div class="wrapper">

<header class="site-header">

  <div class="site-title-container mute-links">
    <h1 class="site-title"><a href="https://robjwells.github.io">Primary Unit mirror on GitHub</a></h1>
    <p class="site-byline"><i>by</i> Rob Wells</p>
  </div>

  <div class="site-menu-container">

    <nav id="site-nav">
      <ul class="site-links mute-links">
        <li><a href="/about/">About</a></li>
        <li><a href="/archives/">Archives</a></li>
        <li><a href="/feed.json">JSON&nbsp;feed</a></li>
        <li><a href="/rss">RSS&nbsp;feed</a></li>
      </ul>
    </nav>

    <label for="search-field" class="site-search-label">
      Site search
    </label>
    <form id="site-search" class="site-search" method="get" action="https://duckduckgo.com/">
      <input name="q" type="text" id="search-field" class="search-field" placeholder="via DuckDuckGo">
      <input name="sites" value="https://robjwells.github.io" hidden>
      <button type="submit" class="search-button">Search</button>
    </form>

  </div> <!-- .site-menu-container -->

</header> <!-- .site-header -->

<main role="main">

  <article>
    <header>
      <h2 class="mute-links"><a href="https://robjwells.github.io/2015/02/my-email-nightmare/">My email nightmare</a></h2>
      <p><time datetime="2015-02-25T12:35">Wednesday, February 25 2015</time></p>
    </header>
    <p>At work we have about 40 employees. A couple of weeks ago I moved our email to a new provider (<a href="https://fastmail.com">FastMail</a>). It took a while to get to but most of the activity was extremely concentrated, and that led me to make some mistakes. However, the move was successful, and hopefully my experience can smooth the way for people in a similar situation.</p>
<h3>Background</h3>
<p>From what I can tell, we’d been running our email through cPanel on a <a href="https://ukwebsolutionsdirect.co.uk">shared host</a> since 2003. (I was hired in 2010 and this became my responsibility in May 2014.)</p>
<p>It wasn’t really an appropriate choice for a business. We had a small amount of space (9GB) shared between all employees. When users (or the entire account) exceeded their quota, the software would bounce incoming emails and send a shaming email to senders. Lots of simple things (holiday automatic replies) required my involvement.</p>
<p>In addition, our domain’s DNS records were also managed through cPanel, tying the settings for our domain to our host (who were also our registrar at this point, so not totally unreasonable).</p>
<p>The host wasn’t great either.</p>
<ul>
<li>To use SSL encryption, our email clients had to point to their server (not our own domain). This isn't a problem, except that one weekday afternoon in November they moved us to a different server without warning, breaking our email clients.</li>
<li>Our contacts, using major webmail services, would sometimes have their provider refuse to send mail to us because our shared server had been placed on a <a href="https://en.wikipedia.org/wiki/DNSBL">blackhole list</a>.</li>
<li>Five failed login attempts within two minutes would trigger an IP block. Starting an email client and, wondering why nothing’s happening, pressing the check mail button twice would shut down one of our two office lines. (POP/IMAP &amp; SMTP authentication counted as separate attempts.)</li>
</ul>
<p>That last one was really fun in combination with the November server move, as I went round the office changing people’s email settings. Their support workers, however, were helpful.</p>
<p>And about two-thirds of our employees were accessing their email over POP, with nothing stored on our server.</p>
<p>We were in a pretty bad state. (Hopefully little of this sounds familiar to you.)</p>
<h3>Preparation</h3>
<p>The biggest task before the switch itself was to move everyone using POP to access their mail to IMAP, otherwise when it came time to do the migration there’d be nothing to move across. They’d have to keep the old POP account in their client forever to be able to access old mail (one remote worker has had to do this because they couldn’t manage to set up IMAP access to their account in <a href="https://en.wikipedia.org/wiki/Microsoft_Entourage">Entourage</a>, their version of which is <a href="https://en.wikipedia.org/wiki/Microsoft_Office#Microsoft_Office_2001_and_v._X">old and busted</a>).</p>
<p>For machines you can access personally this is fairly straightforward but dull. You generally can’t convert a client account from POP to IMAP, so set up a parallel account in the client and move messages into the IMAP version’s folders. If you have people using Entourage X or 2004 beware that moving messages between accounts will not preserve the original received date. I was moving everyone to Apple Mail — the only OS X client I’m going to support — and had to change the date column to use <em>date sent</em>.</p>
<p>With remote workers you’re reliant on their technical skills and your ability to give instructions. For non-technical users think seriously about having them keep a disabled POP account as an archive (as mentioned above) as it may not be worth hours of your time trying to guide them on to IMAP.</p>
<p>Ensure that your DNS settings are in a state where all that’s needed to do is to flip the MX records during the transition. You want to be able to pull the plug on your old provider without the world stopping. In our case, I transferred our domain to <a href="https://www.hover.com">Hover</a> and recreated the records. (cPanel stores MX and other records separately.)</p>
<p>You’ll obviously need to draw up a list of accounts that’ll need creating at the new provider, which will give you a chance to rationalise your usage. This is particularly important when moving to a provider that charges per account (as FastMail and seemingly everyone else does). FastMail has a CSV import feature which will let you create many accounts in one step. (I just used regex in BBEdit to transform a simple list into the required format.)</p>
<p>In our case, the biggest change was the ability to create aliases. So instead of five separate arts desk accounts we now have one main account, with aliases filing mail into subfolders. Combined with pruning unnecessary accounts, this meant I was able to almost halve the number we needed.</p>
<p>Aliases also let me clean up our unpredictable account names, so that everyone is now firstnamesurname@, while ensuring that all mail sent to the old addresses ends up in the right place.</p>
<p>You can get started on this list at any point, and it was one of the first things that I did after getting approval. But as you approach D-Day you need to <em>make sure that the list is up to date</em>. I failed to do this and, while it didn't cause major problems, it caused me to panic a bit as I scrambled to get the missing accounts up and running.</p>
<h3>Transition</h3>
<p>It will benefit you greatly if you draw up a plan for the transition. That includes choosing a D-Day, and detailing what actions you are going to perform and in which order. My biggest mistake was to let a worsening of the problems detailed above force my hand and act hastily. Do everything you can to avoid this and work according to plan.</p>
<p>Your D-Day list should include:</p>
<ol>
<li>Business sign-up and payment. (You may be ready but is the person with the company card?)</li>
<li>User account creation. (Double-check you're not missing any.)</li>
<li>User migration and client settings switch. (You can’t split these.)</li>
<li>MX record switch.</li>
</ol>
<p>1 &amp; 2 are straightforward, although after the second you may want to spend some time cleaning up autofilled names for non-personal accounts (Ms Acme C Department) and corresponding global address book entries.</p>
<p>You’ll need to decide on a migration strategy. <a href="https://www.fastmail.com/help/business/migrate.html">The FastMail help</a> for this is very good. For any sizeable number of accounts you’ll want the second option: set up the accounts then for each user set up forwarding at the old provider, migrate existing mail and then change the user’s settings.</p>
<p>As soon as you enable forwarding for a user the clock is ticking for you to change the user’s settings. Perform the IMAP migration and the clock ticks faster. The longer you wait the more the user’s new account will diverge from the old one.</p>
<p>This is where I made <em>by far my biggest mistake</em>, one which forced me to work through the night to complete the switchover. I set up forwarding for and migrated each user in one block, without changing any client settings. If I hadn’t then spent hours changing everyone’s client settings I would have had to purge the accounts and start over with the IMAP migration. That’s a pain because after each import  for each account you’ll probably have to do some housekeeping (moving sent mail into FastMail’s sent folder, junk to junk, and so on).</p>
<p>Note the order of actions on <a href="https://www.fastmail.com/help/business/migrate.html">the FastMail help page</a>:</p>
<ol>
<li>Forward the user’s new mail,</li>
<li>Migrate the user’s existing mail,</li>
<li>Change the user’s settings,</li>
<li>Then <em>and only then</em> move on to the next user.</li>
</ol>
<p>Completely moving a user allows you to take as long as you need to complete the whole transition. Given other pressures on me at work, it’s likely that it would’ve taken weeks to move everyone. Making this mistake at least forced me to complete the entire thing quickly, even if it meant working a 19-hour shift. (I started working on the emails in earnest after a full day working on edition.)</p>
<p>If you have remote workers you’ll need a strategy for them too. Mine was to send them all emails (to their personal accounts) containing a warning that their mail clients would be broken, new settings if they felt comfortable enough changing them, and instructions on how to access the web interface.</p>
<p>Once you’ve got everyone moved over, flip the switch on the MX records so that new mail flows directly to the new provider.</p>
<h4>Aside: hosting your DNS with FastMail</h4>
<p>FastMail encourages you to host your DNS with them. I haven’t done it for <code>robjwells.com</code> or work because I feel that there should be a separation there (DNS settings stay with <a href="https://www.hover.com">the registrar</a>) and I’m not intimidated by DNS records (although they’re a massive pain).</p>
<p>But if, say, <a href="http://daveplummer.net">my stepdad</a> wanted email for <a href="http://daveplummer.net">his business</a> I’d tell him to let FastMail handle his DNS settings. If I leave the Star I may switch the DNS to FastMail if there’s no-one sufficiently technical to take over from me.</p>
<p>I did briefly switch work to use FastMail’s DNS two nights ago, to see if it enabled automatic configuration in Apple Mail or Thunderbird. No difference. (Our domain publishes SRV records that are meant to help with this and I thought I might have made a mistake, but no dice with either. Outlook may be a different story, but as we’re a mostly Mac office who cares?)</p>
<h3>Afterwards</h3>
<p>The actual change in email provider should largely be invisible to your users. Your biggest problem is going to be what I’ll call user education. Some of this will be straightforward. In our case, an example was to get people to check their spam folder (we previously had daily quarantine emails).</p>
<p>But some will be more personal and political. That you won’t set up or support their <a href="https://en.wikipedia.org/wiki/Microsoft_Entourage">terrible email client</a>. That email aliases really do work. That, no, their emails are not mysteriously disappearing.</p>
<p>A nice bonus for me is that I’m now not responsible for fixing whole categories of problems, and I’m <a href="http://blog.fastmail.com/2014/12/01/fastmail-advent-2014/">very confident in the FastMail staff</a>.</p>
<p>But frankly this whole thing has been a nightmare (including writing this damn post, which has taken forever) and it’s a huge relief to have it sorted.</p>
  </article>

</main>

<footer class="site-footer">
  <small class="mute-links">
    This work is licensed under a
    <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">
    Creative Commons Attribution 4.0 International License</a>.
  </small>
</footer> <!-- .site-footer -->

</div> <!-- .wrapper -->

</body>

</html>