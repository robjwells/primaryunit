<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Primary Unit mirror on GitHub</title>

  <!-- Load my combined stylesheet -->
  <link rel="stylesheet" href="/resources/all.min.css">


  <link rel="license" href="https://creativecommons.org/licenses/by/4.0/">

  <link rel="alternate" type="application/rss+xml" title="RSS feed for Primary Unit" href="/rss">
  <link rel="alternate" type="application/json" title="JSON feed for Primary Unit" href="/feed.json">

  <!-- Apple pinned sites icon, Apple touch icon, Favicon -->
  <link rel="mask-icon" href="/resources/favicon.svg" color="#1369BF">
  <link rel="apple-touch-icon-precomposed" href="/resources/favicon.png">
  <link rel="icon" href="/resources/favicon.ico">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="A mirror of https://www.robjwells.com hosted on GitHub">
</head>

<body>

<div class="wrapper">

<header class="site-header">

  <div class="site-title-container mute-links">
    <h1 class="site-title"><a href="https://robjwells.github.io">Primary Unit mirror on GitHub</a></h1>
    <p class="site-byline"><i>by</i> Rob Wells</p>
  </div>

  <div class="site-menu-container">

    <nav id="site-nav">
      <ul class="site-links mute-links">
        <li><a href="/about/">About</a></li>
        <li><a href="/archives/">Archives</a></li>
        <li><a href="/feed.json">JSON&nbsp;feed</a></li>
        <li><a href="/rss">RSS&nbsp;feed</a></li>
      </ul>
    </nav>

    <label for="search-field" class="site-search-label">
      Site search
    </label>
    <form id="site-search" class="site-search" method="get" action="https://duckduckgo.com/">
      <input name="q" type="text" id="search-field" class="search-field" placeholder="via DuckDuckGo">
      <input name="sites" value="https://robjwells.github.io" hidden>
      <button type="submit" class="search-button">Search</button>
    </form>

  </div> <!-- .site-menu-container -->

</header> <!-- .site-header -->

<main role="main">

  <article>
    <header>
      <h2 class="mute-links"><a href="https://robjwells.github.io/2018/06/hardware-choices/">Hard(ware) choices</a></h2>
      <p><time datetime="2018-06-10T21:50">Sunday, June 10 2018</time></p>
    </header>
    <p>It looks like my 2011 iMac might be on the way out. I’ve been having odd graphical problems today and yesterday, and I think that it might be the graphics card overheating. Running Apple Diagnostics (Hardware Test as was) reports an error with the hard drive (<a href="https://www.ifixit.com/Answers/View/488225/Apple+Hardware+Test+Result+%3A+4M0T-4-40000003%3A+HDD-1510">the fan specifically</a>) which I’ve seen before. My working theory at this point is that a failed or obstructed fan coupled with dust build-up and the fairly hot room has led to this point.</p>
<p class="full-width">
    <img src="/images/2018-06-10-imac-graphics-problem.jpeg"
         alt="Photo of an iMac where part of the right-hand section of the screen image is displayed physically on the left">
</p>

<p>I’m going to get some compressed air and see if that helps matters at all, and then see if I can get it serviced. Unfortunately Apple now lists the 2011-model iMac as obsolete (or “vintage”) so we’ll see how that goes.</p>
<p>Funnily enough, this is not the original graphics card but a replacement installed by Apple when something similar (but not quite the same) happened several years ago, sorted out just before their replacement period ended (it was an acknowledged, somewhat widespread problem with the cards).</p>
<p>Honestly it’s happened at a bit of a naff time. The machine is otherwise fine, and it still feels incredibly fast (which I put down to the SSD). I was hoping it would last as long as many of the machines we have at work, almost all of which are from 2008 (despite what other press reports claim), though they do feel sluggish — particularly the couple that I (foolishly) upgraded past OS X 10.6. I was certainly not planning to replace it yet.</p>
<p>It would be an expense that I could do without too — having just bought <a href="https://www.back2.co.uk/okamura-cp-mesh-chair-black-silver-frame.html">a real chair</a> and <a href="https://www.kinesis-ergo.com/shop/advantage2/">weird keyboard</a> in anticipation of having to do much more work at home from October when I start an evening Masters in Computer Science at <a href="http://www.birkbeck.ac.uk/">Birkbeck</a>.</p>
<p>Which brings us neatly to the real annoyance about this: I was planning to buy a laptop to use on the course. I’ve bought a couple of bottom-end MacBook Airs for reporters at work, and they seem like decent enough machines. This idea was on the assumption that it would not be my main computer, so it could be less capable as I would be using it for focused tasks and leaving everything else — including much of the academic work of the course — to be done on my giant iMac at home.</p>
<p>But if the iMac isn’t in the picture anymore, what should I do? As I see it, I have two feasible options:</p>
<ul>
<li>Buy a more capable laptop as my main computer.</li>
<li>Buy a basic laptop and a new iMac.</li>
</ul>
<p>I spent a lot of money on the 27" iMac in October 2011, buying more than I needed really (partly because I was still playing computer games then). I wouldn’t replace it with something as high-end now as I know that I just don’t need the power, and I want to minimise the hit to my savings. </p>
<p>Part of me thinks that I should buy a MacBook Air now, according to plan but sooner than planned. Then I have something to tide me over other than a six-year-old iPad (running iOS 9!) and a five-year-old iPhone 5S, and then I can try to get the iMac fixed or replace it at a later date. (I’m also a bit anxious to buy the Air sooner rather than later, even though it’s still basically an old design, as I don’t really want to risk having to buy a laptop with a <a href="https://theoutline.com/post/2402/the-new-macbook-keyboard-is-ruining-my-life">dodgy keyboard</a> and only a couple of those odd USB-C sockets.)</p>
<p>Then the other option is to shelve completely the idea of buying another desktop and just buy a more powerful laptop. This appeals to me less, because I do want a bigger screen and I do want more storage.</p>
<p>I’ve been throwing the storage matter around in my head today and I can’t decide on a position. Backblaze tells me I have 530GB backed up, most of which is my iTunes library, so I don’t know if it’s a bit of a distraction — if I only had a laptop I’d have to keep it on an external drive at home, and is that so different from keeping it only in an iMac on my desk?</p>
<p>It’s difficult to know what to do. My gut feeling is to rush out and buy a basic Air immediately so as to not interrupt my life too much (particularly, I need to change jobs before the course starts as the hours don’t fit; this is not a secret to my boss or colleagues).</p>
<p>But my head says that I should see if I can crack on using my iPad for now, enquire about getting the iMac serviced as soon as possible, and then make a more considered decision at a later time.</p>
<p>It’s not a comfortable position for me, since this machine has been a fixture in my life for over six-and-a-half years. When the graphics card went last time, it was calming to know that it was a problem that Apple had committed to take care of (even if I almost missed the cutoff and had to drag the heavy thing all the way to Chafford Hundred on the train). No such luck this time.</p>
<p>(On a, er, positive note, I guess this will finally force me to work out a way of blogging from iPad that isn’t as painful as I’m sure it will be to get this post up.)</p>
  </article>
  <article>
    <header>
      <h2 class="mute-links"><a href="https://robjwells.github.io/2018/05/jupyter-notebook-macro-bug/">Jupyter notebook macro bug</a></h2>
      <p><time datetime="2018-05-22T09:47">Tuesday, May 22 2018</time></p>
    </header>
    <p>My post detailing <a href="/2018/05/open-jupyter-notebooks-with-a-keyboard-maestro-macro/">a Keyboard Maestro macro to open Jupyter notebooks</a> had a dumb bug in the second shell pipeline, which fetches the URL of the desired notebook.</p>
<p>You’d hit it if:</p>
<ul>
<li>You have more than one notebook server running.</li>
<li>The working directory of one is beneath another.</li>
<li>The subdirectory server was started more recently.</li>
<li>You tried to open the parent server with the macro.</li>
</ul>
<p>The shorter path of the parent would match part of the child’s path.</p>
<p>The original <code>grep</code> pattern was:</p>
<pre><code>grep &quot;$KMVAR_dir&quot;</code></pre>


<p>And is now:</p>
<pre><code>grep &quot;:: $KMVAR_dir$&quot;</code></pre>


<p>So that it only matches the exact directory chosen in the list prompt, and not one of its children.</p>
<p>I’ve updated <a href="/files/OpenJupyterNotebook.kmmacros">the Keyboard Maestro macro file</a> too.</p>
  </article>
  <article>
    <header>
      <h2 class="mute-links"><a href="https://robjwells.github.io/2018/05/html-image-dimensions-with-a-css-border/">HTML image dimensions with a CSS border</a></h2>
      <p><time datetime="2018-05-17T21:00">Thursday, May 17 2018</time></p>
    </header>
    <p>When I use images here, I tend to give ones without any transparency a border, which is done using CSS and applied to <code>img</code> tags unless they have a <code>no-border</code> class.</p>
<p>Like a good web citizen, I also <a href="http://w3c.github.io/html/semantics-embedded-content.html#example-82f39213">specify image dimensions in HTML</a>:</p>
<blockquote>
<p>“The image’s rendered size is given in the width and height attributes, which allows the user agent to allocate space for the image before it is downloaded.”</p>
</blockquote>
<p>In fact my BBEdit <code>image</code> snippet makes it a doddle:</p>
<pre><code>&lt;p &lt;#* class=&quot;full-width&quot;#&gt;&gt;
    &lt;img
        src=&quot;/images/#SELECTIONORINSERTION#&quot;
        alt=&quot;&lt;#alt text#&gt;&quot;
        &lt;#* class=&quot;no-border&quot;#&gt;
        width=&lt;#width#&gt;
        height=&lt;#height#&gt;
        /&gt;
&lt;/p&gt;</code></pre>


<p>But this causes a problem, which I’ve spotted in a couple of my recent posts.</p>
<p>If you specify the image dimensions, and use a CSS border, <em>and</em> have your CSS <code>box-sizing</code> set to <code>border-box</code>, then the CSS border shrinks the amount of space available to the image to its specified dimensions − 2 × the border width.</p>
<p>So if you specify your <code>img</code> dimensions to match the dimensions of the file, then the image itself will be shrunk within the element.</p>
<p>This animation shows this situation, and what happens when you toggle the CSS border. Watch what happens to the image itself.</p>
<p class="full-width">
    <img
        src="/images/2018-05-17-border-with-dimensions.gif"
        alt="An animation showing an image being squeezed within the space it has been allocated, causing distortion."
        class="no-border"
        width=565
        height=385
        />
</p>

<p>(It’s got a slight offset from the text because it’s a screenshot of this blog and includes some of the background on each side.)</p>
<p>In contrast, this animation shows what happens when the dimensions are not specified, and so the image is free to grow when the border is applied:</p>
<p class="full-width">
    <img
        src="/images/2018-05-17-border-no-dimensions.gif"
        alt="An animation showing an image growing when a CSS border is applied, with no distortion to the image itself."
        class="no-border"
        width=565
        height=385
        />
</p>

<p>Really the culprit here is <code>box-sizing: border-box</code>, forcing the border to remain within the size of the <code>img</code> element itself. This is a behaviour you actually want, as it solves the old CSS problem of juggling widths, borders and padding within a parent element. Check out <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/box-sizing">MDN’s <code>box-sizing</code> page</a> to see what I mean.</p>
<p>What are my options, then?</p>
<ul>
<li>
<p>Change box-sizing.</p>
<p>I’m not touching this because the potential sizing headaches are not worth it, even just for <code>img</code> elements.</p>
</li>
<li>
<p>Apply a border to the image files themselves.</p>
<p>No, because if I change my mind about the CSS, previously posted images are stuck with the old style forever. CSS borders should also work correctly across high-density displays, whereas a 1px border in the file may not.</p>
</li>
<li>
<p>Don’t specify dimensions in the HTML.</p>
<p>I don’t like the idea of making pages of this site slower to render, but I think this is the least bad option, particularly given that <a href="/2017/04/page-speed/">this site is already pretty fast</a>.</p>
</li>
</ul>
<p>It’s not ideal, but that BBEdit snippet is now just:</p>
<pre><code>&lt;p &lt;#* class=&quot;full-width&quot;#&gt;&gt;
    &lt;img
        src=&quot;/images/#SELECTIONORINSERTION#&quot;
        alt=&quot;&lt;#alt text#&gt;&quot;
        &lt;#* class=&quot;no-border&quot;#&gt;
        /&gt;
&lt;/p&gt;</code></pre>


<p>Hey, at least it makes images quicker to include in posts!</p>
  </article>
  <article>
    <header>
      <h2 class="mute-links"><a href="https://robjwells.github.io/2018/05/open-jupyter-notebooks-with-a-keyboard-maestro-macro/">Open Jupyter notebooks with a Keyboard Maestro macro</a></h2>
      <p><time datetime="2018-05-17T19:45">Thursday, May 17 2018</time></p>
    </header>
    <p>I have a startup item that launches a Jupyter notebook so that the server is always running in the background. It’s an attempt to reduce the friction of using the notebooks.</p>
<p>By default, Jupyter starts the server on port 8888 on localhost, but expects a token (a long hexadecimal string) before it’ll let you in. If you list the currently running servers in the terminal you can see the token and also the server’s working directory.</p>
<pre><code>% jupyter-notebook list
Currently running servers:
http://localhost:8889/?token=…hex… :: /Users/robjwells
http://localhost:8888/?token=…hex… :: /Users/robjwells/jupyter-notebooks</code></pre>


<p>We can use this to make finding and opening the particular notebook server you want a bit easier, using Keyboard Maestro.</p>
<p>
    <img
        src="/images/2018-05-17-macro-overview.png"
        alt="A screenshot showing the (minimised) Keyboard Maestro steps"
        />
</p>

<p>The macro uses the <code>jupyter-notebook</code> command, so that’ll need to be in your <code>$PATH</code> as Keyboard Maestro sees it.</p>
<p>The first and third steps both execute <code>jupyter-notebook list</code> and use Unix tools to extract parts from it.</p>
<p>In between, if there’s more than one notebook server running, the macro prompts the user to choose one from a list of their working directories.</p>
<p>
    <img
        src="/images/2018-05-17-notebook-list.png"
        alt="A Keyboard Maestro list selection dialogue"
        class="no-border"
        width=534
        height=464
        />
</p>

<p>Here’s the first step, where we fetch the list of working directories.</p>
<pre><code>jupyter-notebook list | tail -n +2 | awk '{print $3}'</code></pre>


<p>Our +2 argument to <code>tail</code> gets the output from the second line, chopping off the “Currently running servers:” bit. Then <code>awk</code> prints the third field, which contains the directory. (The first is the URL, the second the double-colon separator.)</p>
<p>The third step fetches the corresponding URL for a directory:</p>
<pre><code>jupyter-notebook list | grep &quot;:: $KMVAR_dir$&quot; | awk '{ print $1 }'</code></pre>


<p>Since the user has specified a directory already, we use <code>grep</code> with the Keyboard Maestro variable to find just that one line, and use <code>awk</code> again to extract the URL field.</p>
<div class="flag" id="update-20180522">
  <p><strong>Update: <time>2018-05-22</time></strong></p>
  <p>There was a bug in the original version of this snippet of shell script, where a parent path could match a child path (as it was only looking for the path itself without an anchor on either side). It was only luck that had me miss this with my example, with the more recently started home directory notebook server being listed ahead of one in a subdirectory, which <code>grep</code> would have also matched. The code above and the macro file have been fixed.</p>
</div>

<p>Obviously, this won’t work if you have more than one notebook server running from the same directory. (But you wouldn’t do that, right?)</p>
<p><a href="/files/OpenJupyterNotebook.kmmacros">Here’s the macro file</a> if you’d like to try it out.</p>
  </article>
  <article>
    <header>
      <h2 class="mute-links"><a href="https://robjwells.github.io/2018/05/horizontally-scroll-a-table-in-html/">Horizontally scroll a table in HTML</a></h2>
      <p><time datetime="2018-05-11T23:35">Friday, May 11 2018</time></p>
    </header>
    <p>After I published <a href="https://www.robjwells.com/2018/05/table-manipulation-with-r/">my post about manipulating tables (of data) in R</a>, I noticed that there was something amiss with the HTML table in that post showing an example section of our newsroom rota.</p>
<p class="full-width">
    <img
        src="/images/2018-05-11-table-fixed.png"
        alt="A screenshot showing a table laid out with table-layout: fixed in CSS, with many cells wrapping with scrollbars in an unreadable fashion."
        />
</p>

<p>When I first wrote the CSS for this site, <a href="https://www.robjwells.com/2013/07/five-different-kinds-of-grey/">roughly five years ago</a>, I had HTML tables set so that the whole table would scroll were it to be too wide for its containing column. At least, I’m pretty sure it worked like that.</p>
<p>Anyway, as you can see above, it doesn’t work like that now. The table there is laid out with the following CSS:</p>
<pre><code>table {
  table-layout: fixed;
  width: 100%;
}</code></pre>


<p>Which has the effect of restricting the table size to 100%, and doing odd things to the cells if there’s too much to fit in whatever width 100% happens to be.</p>
<p>As an attempted quick fix, I removed the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/table-layout"><code>table-layout</code></a> property so that it would inherit the default, <code>auto</code>. The width is still 100% to provide some consistency, rather than having an odd assortment of table widths.</p>
<p>So the CSS is now this:</p>
<pre><code>table {
  width: 100%;
}</code></pre>


<p>This has the effect of having the table overflow the container horizontally if the content is too wide, like so:</p>
<p class="full-width">
    <img
        src="/images/2018-05-11-table-auto.png"
        alt="A screenshot showing a table laid out with table-layout: auto in CSS, with the table overflowing its container horizontally."
        />
</p>

<p>Which is perhaps more readable if pretty ugly. And not what I wanted: to scroll the entire table within its container.</p>
<p>I said attempted earlier because I, er, never deployed the change on the site (it’s been a busy couple of weeks, contrary to the post tempo).</p>
<p>In the meantime, I stumbled across a fix by opening Safari’s reader mode, in which tables scroll horizontally within their container! The secret? The table is wrapped in an enclosing <code>div</code>, which has its <code>overflow-x</code> property set to <code>auto</code>, and then the table scrolls within the div.</p>
<p>Here’s what that looks like when rendered:</p>
<p class="full-width">
    <img
        src="/images/2018-05-11-table-div.png"
        alt="A screenshot showing a table laid out and scrolling within a containing div with its overflow-x property set to auto."
        />
</p>

<p>Here’s the HTML:</p>
<pre><code>&lt;div class=&quot;table-container&quot;&gt;
  &lt;table&gt;
  …
  &lt;/table&gt;
&lt;/div&gt;</code></pre>


<p>And here’s the CSS:</p>
<pre><code>table {
  width: 100%;
}

.table-container {
  overflow-x: auto;
}</code></pre>


<p>You want <code>auto</code> instead of <code>scroll</code> as the latter shows the scrollbar all the time. </p>
  </article>
  <div class="pagination">
<p class="pagination-older"><a href="https://robjwells.github.io/page-2/">Older posts</a></p>  </div>

</main>

<footer class="site-footer">
  <small class="mute-links">
    This work is licensed under a
    <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">
    Creative Commons Attribution 4.0 International License</a>.
  </small>
</footer> <!-- .site-footer -->

</div> <!-- .wrapper -->

</body>

</html>